import Debug.Trace

type Pair = ((Int, Int), (Int, Int))

contained :: [Int] -> [Int] -> Bool
contained (x:xs) (y:ys)
    | x /= y = (not $ null (filter (==x) ys)) || contained xs (y:ys)
    | otherwise = True
contained _ _ = False

splitOn :: Char -> String -> [String]
splitOn _ [] = []
splitOn delim target = 
    let (x, xs) = span (/= delim) target in 
        x : (splitOn delim (if null xs then [] else tail xs))

toPair :: String -> [Pair]
toPair x = map (\[y, z] -> (pairToInt y, pairToInt z)) (map (splitOn ',') (splitOn '\n' x))

pairToInt :: String -> (Int, Int)
pairToInt x = (read y :: Int, read z :: Int) 
    where [y, z] = splitOn '-' x

eval :: Pair -> Bool
eval ((a, b), (c, d)) = contained [a..b] [c..d]

solution :: String -> Int
solution x = sum (map (\x -> if eval x then 1 else 0) (toPair x))

--main = print (solution "2-4,6-8\n2-3,4-5\n5-7,7-9\n2-8,3-7\n6-6,4-6\n2-6,4-8")
--main = print (pairToInt "10-20")
--main = print (splitOn '-' "10-20")
--main = print (contained [5..10] [5..20])
main = print (solution "8-82,3-96\n13-95,99-99\n4-92,5-93\n16-80,16-80\n23-36,6-10\n82-98,24-83\n48-48,47-48\n58-81,58-80\n14-14,13-98\n46-66,45-46\n38-73,37-72\n46-99,47-47\n15-59,6-56\n13-54,12-53\n60-61,60-71\n4-97,2-97\n6-94,6-94\n47-48,38-48\n10-95,10-95\n84-87,86-86\n51-88,70-84\n3-52,51-53\n21-55,21-21\n55-84,31-56\n18-18,19-75\n63-76,64-77\n44-94,93-98\n9-62,2-4\n29-34,28-33\n14-97,15-98\n10-56,10-56\n3-92,4-93\n44-92,45-93\n7-73,6-72\n12-96,12-12\n17-83,82-83\n8-94,9-97\n1-96,2-96\n82-93,4-81\n45-62,3-62\n91-96,3-81\n69-87,68-95\n43-67,44-55\n2-99,87-97\n41-47,40-48\n84-99,21-84\n9-47,8-46\n7-86,31-37\n44-95,28-99\n1-96,6-94\n79-79,1-80\n44-62,44-62\n17-17,16-62\n19-80,19-19\n31-54,12-53\n62-91,90-99\n1-99,3-99\n28-63,29-63\n46-78,61-78\n16-24,23-91\n25-77,24-24\n58-99,57-98\n46-86,8-87\n44-44,45-77\n36-71,51-71\n26-79,25-79\n4-69,44-53\n33-78,95-99\n46-67,23-47\n16-51,15-50\n72-91,28-72\n96-98,10-97\n4-98,3-98\n3-98,8-96\n92-96,6-93\n62-99,97-99\n2-2,1-24\n23-25,24-90\n14-77,14-78\n95-95,3-96\n18-78,8-17\n34-92,33-91\n4-4,4-4\n28-59,32-60\n30-32,20-31\n75-80,6-76\n17-78,41-78\n9-94,9-94\n52-67,51-68\n63-97,78-96\n85-89,10-86\n1-52,51-51\n8-74,7-93\n58-73,26-74\n3-96,96-97\n14-30,15-29\n13-77,12-76\n99-99,7-93\n13-94,93-93\n3-54,1-54\n50-90,50-91\n58-58,57-72\n17-18,18-91\n2-30,6-30\n91-92,74-92\n32-82,31-83\n41-52,42-53\n93-96,60-93\n53-70,53-70\n69-97,69-70\n3-54,3-55\n41-55,6-56\n46-48,47-48\n10-42,9-9\n75-80,3-76\n43-56,44-44\n60-61,60-69\n31-93,32-92\n12-63,13-62\n94-95,46-95\n68-68,1-69\n22-89,18-95\n14-32,17-33\n10-75,9-76\n31-96,31-97\n85-85,5-86\n22-31,21-30\n23-77,3-94\n44-44,45-45\n86-93,14-93\n67-99,67-97\n38-95,37-94\n19-21,20-24\n71-71,11-72\n8-47,9-47\n45-78,46-46\n8-9,7-8\n95-97,4-96\n25-78,78-79\n68-68,68-85\n68-78,10-89\n6-80,5-6\n9-88,8-8\n13-92,63-93\n97-97,73-98\n8-45,8-8\n3-93,9-92\n93-93,28-94\n8-78,9-79\n8-95,1-95\n39-66,39-65\n3-32,2-33\n24-36,4-89\n36-96,36-96\n9-73,9-10\n72-87,72-75\n11-97,12-96\n50-79,78-79\n93-93,80-94\n35-95,23-94\n1-89,89-98\n15-97,15-97\n67-86,42-86\n18-49,17-48\n6-93,10-87\n35-56,66-77\n14-99,14-98\n48-62,18-63\n37-57,36-38\n4-6,5-72\n59-93,59-94\n25-69,25-70\n8-78,77-77\n73-73,74-91\n23-34,34-63\n35-96,91-96\n32-71,33-70\n60-81,61-78\n2-80,80-81\n16-85,35-57\n29-70,66-67\n68-84,55-84\n26-66,27-27\n29-74,28-80\n89-91,49-90\n34-35,34-54\n13-96,12-96\n20-45,19-56\n48-97,49-96\n68-70,12-69\n4-95,94-94\n20-84,19-83\n32-34,33-96\n23-53,24-52\n9-11,9-9\n29-30,30-63\n20-80,20-56\n76-95,1-76\n2-68,1-67\n3-60,59-59\n2-22,3-23\n78-92,82-91\n29-99,39-99\n38-46,26-33\n42-61,60-60\n23-23,24-24\n92-96,29-92\n8-90,89-89\n21-29,16-29\n6-75,6-74\n9-11,10-38\n46-80,18-90\n59-65,58-58\n9-91,8-90\n87-91,88-91\n11-95,91-96\n38-95,38-97\n12-97,8-64\n49-54,42-93\n90-90,88-91\n44-80,43-43\n29-88,30-87\n91-93,63-92\n3-83,2-3\n17-94,93-95\n8-91,3-7\n1-92,1-93\n98-99,37-95\n31-31,31-63\n1-96,1-97\n49-94,49-81\n19-84,18-85\n14-91,91-93\n30-41,41-50\n22-39,38-44\n17-93,5-98\n2-79,3-3\n63-93,39-93\n86-86,59-88\n37-47,37-38\n6-68,1-68\n97-98,84-95\n86-88,1-87\n17-87,17-81\n30-55,32-34\n4-4,5-89\n6-97,97-99\n15-97,14-98\n95-96,67-93\n14-39,13-40\n5-78,77-78\n12-48,13-38\n67-83,20-88\n5-90,4-91\n52-74,53-73\n11-96,29-96\n11-27,12-27\n16-47,15-48\n91-99,13-90\n35-89,36-36\n9-12,3-12\n19-19,20-78\n18-78,17-17\n10-42,11-11\n16-16,15-86\n16-34,20-34\n19-99,3-72\n32-88,33-89\n76-78,21-75\n25-65,25-66\n8-93,8-94\n8-9,8-55\n61-67,22-67\n10-63,36-62\n5-93,5-5\n13-88,68-77\n9-30,8-30\n87-89,24-88\n20-51,47-51\n57-59,12-58\n25-75,16-94\n92-95,46-92\n31-94,32-95\n1-76,3-76\n7-59,8-69\n26-58,27-57\n16-59,15-63\n47-49,21-48\n25-68,24-88\n89-89,48-90\n21-72,71-71\n66-79,65-78\n54-55,54-55\n45-88,8-89\n38-68,56-67\n2-82,37-65\n17-73,17-73\n74-80,11-81\n10-56,1-99\n32-72,11-31\n7-40,6-65\n5-49,48-57\n14-15,15-81\n61-83,91-96\n19-87,20-86\n6-67,6-68\n49-95,48-48\n26-28,27-32\n39-62,39-39\n1-78,4-78\n23-87,35-35\n1-1,2-79\n9-40,10-40\n11-96,3-12\n69-72,3-73\n70-85,16-70\n76-84,42-75\n52-53,10-53\n3-15,4-14\n13-83,12-13\n19-76,68-75\n25-43,25-43\n55-60,55-60\n25-52,5-24\n1-91,90-90\n61-79,60-60\n33-39,33-39\n5-14,4-4\n65-67,66-79\n8-9,8-98\n3-86,85-85\n10-42,9-43\n2-25,87-98\n4-77,3-3\n34-87,34-98\n72-77,71-71\n78-97,25-78\n8-9,8-15\n3-97,1-5\n65-90,40-66\n13-77,51-77\n95-97,5-93\n21-61,20-60\n37-96,35-98\n28-96,42-96\n13-81,12-80\n63-70,40-66\n73-93,92-97\n30-87,31-88\n79-94,80-80\n42-56,1-43\n16-41,15-42\n16-74,16-74\n52-59,51-60\n77-82,26-76\n3-13,9-12\n2-77,1-78\n4-86,5-86\n1-80,2-31\n31-95,31-83\n38-70,71-81\n36-77,1-78\n9-86,87-94\n9-56,11-56\n1-96,1-95\n81-88,81-83\n11-74,11-75\n4-97,6-89\n25-78,24-79\n12-36,13-37\n6-97,20-97\n2-91,90-92\n64-67,66-90\n36-44,36-37\n23-23,22-24\n36-66,37-61\n23-33,29-32\n32-97,32-97\n30-95,38-95\n12-99,34-89\n13-98,15-94\n11-90,10-91\n68-94,67-93\n13-93,12-94\n11-91,10-12\n62-72,56-62\n23-70,24-69\n93-93,7-94\n21-67,66-72\n14-44,13-43\n57-81,58-82\n20-73,72-86\n34-34,33-51\n14-21,20-22\n17-41,17-42\n37-64,36-68\n22-89,22-97\n3-86,3-4\n81-91,14-82\n47-90,89-91\n11-56,5-56\n34-80,35-65\n18-62,19-61\n84-96,23-95\n83-87,33-69\n83-91,76-91\n23-60,22-22\n5-7,4-8\n21-22,21-94\n11-56,12-12\n15-81,14-15\n5-5,6-69\n41-73,41-74\n4-22,3-23\n10-97,25-91\n31-37,30-30\n40-69,25-69\n49-72,49-50\n16-76,75-77\n64-95,63-96\n33-86,33-86\n26-26,25-57\n7-91,12-91\n19-97,18-96\n19-70,18-70\n3-98,1-65\n9-55,55-96\n34-83,51-84\n3-6,7-98\n23-24,23-25\n16-85,16-84\n35-97,36-98\n4-12,9-12\n2-98,1-97\n6-79,80-81\n4-5,4-25\n41-53,40-70\n6-94,7-7\n1-96,2-95\n8-83,7-8\n9-31,10-45\n21-57,20-58\n20-78,19-77\n10-10,11-98\n11-77,6-78\n94-95,93-96\n55-84,56-85\n31-78,42-78\n4-88,92-98\n5-74,74-93\n1-98,1-99\n6-84,18-28\n3-90,1-92\n20-92,19-19\n91-91,90-90\n7-99,7-99\n11-95,12-52\n8-8,7-90\n6-70,5-10\n26-92,91-93\n64-90,65-89\n90-92,31-91\n6-7,6-99\n21-75,10-92\n1-95,74-96\n59-64,61-61\n7-15,4-14\n4-97,4-98\n60-60,61-90\n2-99,6-99\n19-84,19-83\n3-36,4-35\n28-37,27-95\n8-9,8-89\n41-58,41-69\n7-72,4-80\n1-20,19-79\n16-67,16-66\n4-5,5-99\n7-20,8-19\n5-99,4-98\n19-37,18-37\n11-33,30-33\n51-70,69-69\n56-96,50-56\n21-79,20-80\n78-78,3-79\n73-97,72-72\n8-80,7-81\n17-18,17-88\n50-83,36-50\n18-20,8-19\n25-31,26-30\n10-92,9-91\n58-98,59-85\n5-95,96-96\n20-97,19-21\n8-97,7-8\n4-83,75-84\n1-68,1-69\n18-38,18-38\n89-93,21-90\n6-84,7-85\n20-90,90-93\n80-90,87-91\n12-96,6-11\n56-77,55-76\n26-28,5-62\n5-87,6-65\n37-39,5-38\n5-5,6-56\n5-94,5-93\n46-63,47-63\n7-88,6-87\n20-93,37-93\n12-97,5-99\n37-87,37-87\n26-99,17-25\n26-70,22-70\n68-70,48-69\n23-31,24-24\n17-32,30-30\n18-18,8-19\n41-58,37-59\n16-61,15-61\n4-98,4-4\n4-4,4-96\n27-61,26-61\n21-29,22-24\n11-14,10-15\n65-99,65-66\n12-95,11-11\n8-99,9-98\n43-58,55-56\n50-51,35-69\n39-39,40-76\n50-52,18-51\n3-88,3-89\n46-53,46-79\n45-88,44-87\n23-95,22-24\n2-90,3-89\n7-7,7-39\n1-85,3-49\n62-69,45-68\n63-94,63-94\n1-2,2-53\n24-73,25-74\n22-69,13-69\n1-97,82-98\n2-41,41-81\n10-96,11-97\n56-71,70-72\n2-75,2-75\n31-49,31-50\n21-81,19-81\n68-69,15-69\n39-39,39-39\n30-30,30-31\n55-83,55-82\n82-83,59-83\n49-74,49-49\n18-39,17-38\n14-80,22-80\n10-78,9-10\n32-90,11-97\n19-73,9-18\n65-73,66-73\n47-68,49-68\n41-71,40-70\n20-37,30-37\n2-25,24-95\n36-84,44-85\n64-64,10-65\n13-60,12-61\n89-89,17-90\n35-86,34-94\n34-34,33-41\n20-44,32-32\n1-61,3-97\n50-51,50-96\n29-30,30-61\n2-96,96-99\n9-32,3-32\n20-29,23-28\n18-62,18-76\n90-95,43-89\n42-80,26-96\n43-93,42-81\n13-97,14-99\n46-90,45-89\n1-93,93-94\n5-5,6-84\n86-89,35-86\n25-79,24-80\n17-25,18-24\n10-79,47-59\n7-72,2-6\n15-61,15-62\n6-28,29-92\n52-69,70-70\n3-4,3-97\n69-88,1-98\n13-18,19-32\n83-85,18-84\n9-29,8-28\n55-89,90-90\n24-71,30-71\n94-96,45-94\n3-3,4-84\n13-98,12-12\n5-95,94-96\n4-70,5-69\n23-90,22-89\n56-62,61-62\n39-84,84-84\n44-60,45-61\n49-58,4-87\n16-36,17-37\n44-45,44-79\n46-61,60-62\n4-61,4-34\n78-78,77-93\n38-93,3-92\n67-85,70-72\n87-87,5-88\n5-30,4-31\n56-88,51-57\n5-75,72-72\n11-64,14-65\n34-83,33-35\n80-99,27-81\n31-82,30-81\n62-62,63-63\n12-85,16-85\n19-43,17-44\n41-42,41-81\n6-79,7-80\n22-84,83-85\n19-19,20-20\n11-98,97-99\n8-76,25-55\n53-53,53-71\n12-79,12-44\n79-85,84-86\n33-46,1-76\n8-77,7-76\n5-69,6-69\n37-57,50-58\n82-84,6-83\n2-98,3-99\n33-36,19-82\n19-92,18-93\n5-5,6-97\n1-38,2-37\n15-19,15-19\n45-77,44-46\n2-59,21-60\n41-66,38-65\n15-48,10-15\n8-97,7-99\n23-95,95-98\n59-60,2-60\n29-30,29-30\n18-62,24-62\n6-97,6-98\n5-92,91-91\n98-98,13-99\n16-80,5-16\n1-77,2-67\n5-75,5-75\n70-70,5-71\n30-71,13-90\n30-82,74-80\n9-10,9-98\n9-90,9-9\n62-64,61-63\n14-51,15-63\n68-97,67-69\n80-92,2-81\n1-97,1-98\n5-96,5-96\n15-44,33-39\n29-84,83-84\n6-24,7-91\n6-27,7-28\n5-97,1-99\n68-77,30-76\n7-82,63-63\n3-71,2-70\n6-36,6-6\n4-62,3-63\n47-98,46-47\n34-62,36-61\n3-69,1-70\n66-96,65-97\n21-69,38-46\n10-40,37-38\n42-96,43-43\n19-57,20-48\n50-91,78-91\n45-67,44-67\n7-86,85-87\n2-95,94-94\n46-46,45-98\n33-85,99-99\n81-82,77-82\n41-43,42-63\n7-64,6-63\n3-4,3-88\n26-97,23-97\n1-2,1-93\n6-77,6-7\n44-49,46-92\n46-80,19-79\n70-95,22-71\n77-95,28-65\n1-18,19-73\n48-97,30-97\n20-44,45-81\n15-82,16-81\n2-33,3-32\n94-95,94-97\n23-36,22-29\n14-50,13-51\n46-50,7-45\n74-89,41-75\n16-31,30-30\n77-99,5-78\n1-70,1-70\n17-74,17-74\n48-49,48-77\n29-95,67-68\n30-30,29-31\n95-98,26-96\n1-4,5-95\n62-62,33-63\n7-85,80-81\n34-77,34-83\n27-84,28-83\n25-45,38-45\n4-99,3-4\n94-96,14-95\n25-99,24-24\n14-88,14-89\n1-9,8-99\n86-92,47-66\n36-37,22-54\n9-91,10-90\n5-61,8-89\n14-96,15-15\n3-94,49-93\n2-19,2-20\n62-97,13-99\n94-96,5-95\n1-75,6-76\n17-81,19-82\n35-93,59-98\n9-42,7-41\n3-5,4-98\n84-93,3-84\n1-64,4-64\n13-86,13-86\n34-89,33-90\n77-79,65-78\n57-59,14-58\n54-58,53-55\n78-86,85-86\n47-99,47-99\n26-43,24-30\n1-63,62-85\n87-87,87-88\n31-82,30-31\n58-84,34-85\n44-67,45-68\n7-11,8-8\n7-69,68-68\n4-85,86-86\n56-57,57-89\n13-92,12-92\n1-96,13-26\n56-66,56-91\n37-37,6-38\n74-98,26-75\n3-83,82-84\n2-97,19-98\n90-96,38-96\n4-21,5-21\n42-95,41-41\n28-28,1-35\n6-73,5-57\n28-90,90-94\n3-83,3-82\n5-5,6-59\n22-23,21-50\n35-61,34-61\n7-87,7-87\n20-93,19-94\n9-78,8-78\n3-61,2-3\n45-61,61-73\n19-72,18-73\n78-97,77-98\n19-91,15-20\n36-36,37-67\n33-93,54-93\n13-63,12-90\n3-99,7-97\n18-78,14-17\n85-99,28-99\n48-99,49-98\n40-68,12-67\n16-51,15-85\n94-98,79-95\n65-69,50-68\n41-42,42-75\n7-43,8-44\n26-95,26-96\n2-99,7-36\n49-53,1-99\n25-25,25-35\n47-83,47-48\n49-52,49-49\n26-94,13-25\n6-72,7-71\n16-33,2-28\n3-51,3-51\n9-66,50-66\n37-91,25-98\n4-96,3-95\n67-73,48-72\n22-86,23-86\n40-49,45-52\n53-68,55-66\n38-50,37-49\n1-86,5-85\n35-62,36-62\n7-62,12-86\n15-30,14-16\n47-65,48-65\n3-85,50-84\n15-98,14-16\n56-66,56-57\n29-30,29-51\n6-45,5-46\n49-93,21-92\n11-38,11-37\n9-42,18-27\n29-38,28-80\n7-8,8-91\n66-70,65-71\n20-91,21-21\n22-83,23-82\n5-38,6-39\n26-28,27-97\n5-65,1-85\n14-94,15-94\n20-97,21-96\n95-99,11-78\n21-83,22-84\n5-91,5-90\n39-40,40-86\n9-54,8-53\n8-99,61-71\n29-38,28-50\n18-96,19-97\n5-80,4-81\n7-99,40-54\n95-95,4-96\n80-89,36-79\n2-63,56-69\n7-29,42-99\n11-23,1-23\n13-52,12-51\n18-96,19-97\n20-68,20-67\n3-95,1-95\n3-88,2-89\n31-32,31-88\n8-98,8-98\n5-98,4-6\n2-2,3-96\n27-69,27-69\n2-96,1-3\n5-87,3-57\n20-42,19-43\n7-8,8-8\n10-60,11-67\n16-81,19-81\n74-84,73-83\n13-93,92-92\n68-70,42-69\n33-34,33-63\n7-70,6-70\n13-88,14-87\n8-41,40-67\n50-85,51-86\n27-61,30-61\n63-73,72-73\n4-53,55-80\n3-72,4-71\n4-98,3-98\n38-64,37-65\n42-42,39-41\n77-88,87-90\n45-86,85-87\n4-87,4-87\n21-22,21-57\n28-92,30-91\n4-13,1-77\n13-36,35-72\n7-8,8-62\n8-68,14-78\n24-92,4-92\n10-50,39-47\n4-57,3-56\n31-31,5-30\n41-41,29-42\n65-97,3-96\n43-75,74-76\n94-94,3-95\n28-48,29-47\n62-72,6-72\n20-97,19-96\n46-59,38-58\n55-86,56-87\n29-56,30-55\n2-90,4-89\n15-15,9-14\n10-92,91-91\n63-63,62-64\n66-70,8-98\n44-92,1-91\n2-80,8-42\n36-50,37-52\n4-54,5-53\n5-88,3-88\n60-96,61-97\n11-24,10-24\n81-83,9-82\n4-97,3-98\n36-76,35-77\n34-40,18-43\n68-69,24-78\n84-86,80-89\n39-94,22-79\n57-93,72-93\n59-78,79-91\n7-97,8-98\n7-27,6-88\n1-6,7-15\n13-86,13-14\n25-27,3-26\n33-75,74-75\n68-87,68-69\n72-96,72-97\n23-36,32-35\n97-99,32-77\n23-64,64-86\n82-84,48-83\n1-93,1-93\n83-93,14-93\n12-97,96-98\n3-22,4-59\n32-77,31-76\n25-92,62-89\n18-20,19-33\n34-73,65-72\n31-82,32-82\n3-92,92-97\n1-99,1-98\n4-98,4-4\n13-84,14-83\n13-61,62-98\n14-15,15-48\n29-76,75-77\n22-75,23-85\n5-5,4-87\n7-51,20-80\n14-65,2-13\n78-85,78-98\n7-97,8-97\n11-67,6-10\n5-72,4-97\n96-99,19-97\n33-48,6-49\n24-24,25-47\n25-82,24-81\n3-91,7-91\n7-72,8-71\n10-35,9-11\n2-2,2-99\n30-41,31-42\n10-66,2-66\n4-77,1-77\n13-13,14-89\n79-86,86-91\n4-86,3-87\n47-92,47-92\n18-32,17-33\n")
